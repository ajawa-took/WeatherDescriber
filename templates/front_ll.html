<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather History</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>

<style>
    table, th, td {
        border: 1px solid white;
        border-collapse: collapse;
        padding: 15px;
    }
    th, td {
        background-color: #c8d7ef;
    }
    .p1 {
    font-family: Arial, Helvetica, sans-serif;
    }

    .button1 {
    background-color: #4285f4;
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    }

    .footer {
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    background-color: #3f5b89;
    color: white;
    text-align: left;
    }

</style>

</head>

<body>
    <h1 class="p1">Get your weather history here!</h1>
    <p class="p1">
        Please fill in the boxes below:
    </p>
    <div>

<!-- --------------------------- 2022-12-21 RL ----- 
    inputs aren't being fed into engine below, 
    unless options are actively selected. -->

    <div>
        <!-- Top-level table -->
        <table class="p1">
            <tr>
                <td>For the Location: 
                    <br> ~ Enter the name of a city (Berkeley)
                    <br> ~ Or enter a city and state, or region, with NO COMMAS (Berkeley CA)
                </td>
                <td>Select a Start Year, Month and Day:
                </td>
                <td>Select an End Year, Month and Day
                </td>
            </tr>
            <tr>
                <td>
                    <form>
                        <input id="location" type="text" size="50">
                    </form>
                </td>

                <td>
                    <div>
                        <!-- Start Dates table -->
                        <table class="p1">
                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="start_year_inputid">Start Year:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="start_year_inputname" id="start_year_inputid">
                                                <!-- <option value="nullstartyear" selected="selected"></option> -->
                                                <option value="2023">2023</option>
                                                <option value="2024">2024</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="start_month_inputid">Start Month:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="start_month_inputname" id="start_month_inputid">
                                                <!-- <option value="nullstartmonth" selected="selected"></option> -->
                                                <option value="01">01 January</option>
                                                <option value="02">02 February</option>
                                                <option value="03">03 March</option>
                                                <option value="04">04 April</option>
                                                <option value="05">05 May</option>
                                                <option value="06">06 June</option>
                                                <option value="07">07 July</option>
                                                <option value="08">08 August</option>
                                                <option value="09">09 September</option>
                                                <option value="10">10 October</option>
                                                <option value="11">11 November</option>
                                                <option value="12">12 December</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="start_day_inputid">Start Day:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="start_day_inputname" id="start_day_inputid">
                                                <!-- <option value="nullstartday" selected="selected"></option> -->
                                                <option value="01">01</option>
                                                <option value="02">02</option>
                                                <option value="03">03</option>
                                                <option value="04">04</option>
                                                <option value="05">05</option>
                                                <option value="06">06</option>
                                                <option value="07">07</option>
                                                <option value="08">08</option>
                                                <option value="09">09</option>
                                                <option value="10">10</option>
                                                <option value="11">11</option>
                                                <option value="12">12</option>
                                                <option value="13">13</option>
                                                <option value="14">14</option>
                                                <option value="15">15</option>
                                                <option value="16">16</option>
                                                <option value="17">17</option>
                                                <option value="18">18</option>
                                                <option value="19">19</option>
                                                <option value="20">20</option>
                                                <option value="21">21</option>
                                                <option value="22">22</option>
                                                <option value="23">23</option>
                                                <option value="24">24</option>
                                                <option value="25">25</option>
                                                <option value="26">26</option>
                                                <option value="27">27</option>
                                                <option value="28">28</option>
                                                <option value="29">29</option>
                                                <option value="30">30</option>
                                                <option value="31">31</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>

                <td>
                    <div>
                        <!-- End Dates table -->
                        <table class="p1">
                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="end_year_inputid">End Year:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="end_year_inputname" id="end_year_inputid">
                                                <!-- <option value="nullendyear" selected="selected"></option> -->
                                                <option value="2023">2023</option>
                                                <option value="2024">2024</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="end_month_inputid">End Month:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="end_month_inputname" id="end_month_inputid">
                                                <!-- <option value="nullendmonth" selected="selected"></option> -->
                                                <option value="01">01 January</option>
                                                <option value="02">02 February</option>
                                                <option value="03">03 March</option>
                                                <option value="04">04 April</option>
                                                <option value="05">05 May</option>
                                                <option value="06">06 June</option>
                                                <option value="07">07 July</option>
                                                <option value="08">08 August</option>
                                                <option value="09">09 September</option>
                                                <option value="10">10 October</option>
                                                <option value="11">11 November</option>
                                                <option value="12">12 December</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>

                            <tr>
                                <td>
                                    <div>
                                        <form>
                                            <label for="end_day_inputid">End Day:</label>
                                        </form>
                                    </div>
                                </td>

                                <td>
                                    <div>
                                        <form>
                                            <select name="end_day_inputname" id="end_day_inputid">
                                                <!-- <option value="nullendday" selected="selected"></option> -->
                                                <option value="01">01</option>
                                                <option value="02">02</option>
                                                <option value="03">03</option>
                                                <option value="04">04</option>
                                                <option value="05">05</option>
                                                <option value="06">06</option>
                                                <option value="07">07</option>
                                                <option value="08">08</option>
                                                <option value="09">09</option>
                                                <option value="10">10</option>
                                                <option value="11">11</option>
                                                <option value="12">12</option>
                                                <option value="13">13</option>
                                                <option value="14">14</option>
                                                <option value="15">15</option>
                                                <option value="16">16</option>
                                                <option value="17">17</option>
                                                <option value="18">18</option>
                                                <option value="19">19</option>
                                                <option value="20">20</option>
                                                <option value="21">21</option>
                                                <option value="22">22</option>
                                                <option value="23">23</option>
                                                <option value="24">24</option>
                                                <option value="25">25</option>
                                                <option value="26">26</option>
                                                <option value="27">27</option>
                                                <option value="28">28</option>
                                                <option value="29">29</option>
                                                <option value="30">30</option>
                                                <option value="31">31</option>
                                            </select>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <div>
        <p></p>
        <p>
            <button id="get_links" class="button1">Generate Link</button>
        </p>
    <h1 class="p1">
    <a id="history-link">Go to Weather History JSON</a>
    <!-- <a><button id="history-link" class="button2">Go to Weather JSON</button></a> -->
    </h1>
    <!-- <p>
    <a id="seasons-link">Seasons</a>
    </p> -->
    </div>

    <div>
        <p class="p1">
            Data Sources:
            <p class="p1">
            <strong>Weather API</strong>
            <br>
            <em>60 years global archive with hourly values at 0.25° resolution</em>
            <br>
            <a href>https://open-meteo.com/en/docs/historical-weather-api</a>
            <br>
            <em>
            Generated using Copernicus Climate Change Service information 2022.  
            All users of Open-Meteo data must provide a clear attribution to the 
            Copernicus program as well as a reference to Open-Meteo.
            <br>
            Our data source is the ERA5 historical weather reanalysis dataset, 
            obtained through the Open-Meteo historical weather API.
            <br>
            The ERA5 was created by the European Copernicus Climate Change Service 
            information 2022, in collaboration with the European Centre for 
            Medium-Range Weather Forecasts.
            </em>
            </p>
            <p class="p1">
            <strong>LocationIQ</strong>
            <br>
            <em><a href="https://locationiq.com">LocationIQ</a>: Affordable, Scalable & Reliable location services since 2013.</em>
            </p>
        </p>
    </div>
    
    <script type="text/javascript">
        // getting references
        var location_field = d3.select("#location");
        var start_year_field = d3.select("#start_year_inputid");
        var start_month_field = d3.select("#start_month_inputid");
        var start_day_field = d3.select("#start_day_inputid");
        var end_year_field = d3.select("#end_year_inputid");
        var end_month_field = d3.select("#end_month_inputid");
        var end_day_field = d3.select("#end_day_inputid");
        var the_button = d3.select("#get_links");
        var history_link_thing = d3.select("#history-link");
        var seasons_link_thing = d3.select("#seasons-link");

        // AM: global variables to hold 4 inputs - i'm sure this is kludge
        // LL: Adding default values, in case user input is missing.
        var location_val = "Paris";
        var start_year_val = "2023";
        var start_month_val = "01";
        var start_day_val = "01";
        var end_year_val = "2023";
        var end_month_val = "01";
        var end_day_val = "02";

        // https://stackoverflow.com/questions/1085801/get-selected-value-in-dropdown-list-using-javascript
        // var getValue = document.getElementById('ddlViewBy').selectedOptions[0].value;
        // var getValue_startyear = document.getElementById['start_year_inputid'].selectedOptions[0].value;



        // functions linking input fields to their variables
        location_field.on("change", function() {
            location_val = d3.event.target.value;
            console.log("location", location_val);
        });

        start_year_field.on("change", function() {
            start_year_val = d3.event.target.value;
            console.log("start year", start_year_val);
        });

        start_month_field.on("change", function() {
            start_month_val = d3.event.target.value;
            console.log("start month", start_month_val);
        });

        start_day_field.on("change", function() {
            start_day_val = d3.event.target.value;
            console.log("start day", start_day_val);
        });

        end_year_field.on("change", function() {
            end_year_val = d3.event.target.value;
            console.log("end year", end_year_val);
        });

        end_month_field.on("change", function() {
            end_month_val = d3.event.target.value;
            console.log("end month", end_month_val);
        });

        end_day_field.on("change", function() {
            end_day_val = d3.event.target.value;
            console.log("end day", end_day_val);
        });

        // the function that fills urls
        the_button.on("click", function() {
            var urrl = location_val + "/" + start_year_val + "-" + start_month_val + "-" + start_day_val + "/" + end_year_val + "-" + end_month_val + "-" + end_day_val;
            history_link_thing.attr("href", "pretty/v1.0/history_loc/"+urrl );
            seasons_link_thing.attr("href", "seasons/"+urrl );
        });

    </script>


<!-- <a href="http://example.com" target="_blank"><input type="button" value="Link-button"></a> -->

</body>
</html>